### üß± Milestone: flujo autom√°tico de permisos validado

- Se confirma que el trigger `trigger_insertar_permisos` en la tabla `usuarios` est√° activo y funcional
- La funci√≥n `asignar_permisos_usuario()` ejecuta correctamente la inserci√≥n de permisos
- Se validan los accesos autorizados en la tabla `permisos_usuario` para el usuario insertado
- Se institucionaliza el flujo de permisos como parte del onboarding t√©cnico
- Se garantiza compatibilidad con el hook `usePermisos` y el render condicional en `App.tsx`

### üß± Registro de intentos fallidos y cambios repetidos

- Se introdujo el hook `usePermisos` para modularizar la visibilidad de m√≥dulos
- Se detect√≥ que el `usuarioId` no siempre coincide con el `usuario_id` en Supabase
- Se intent√≥ corregir el render condicional en `App.tsx` m√°s de 6 veces sin √©xito
- Se verific√≥ el trigger y la funci√≥n `asignar_permisos_usuario`, que funcionan correctamente
- Se confirm√≥ que los permisos existen en la tabla `permisos_usuario`
- El frontend sigue sin mostrar los m√≥dulos, lo que indica un fallo en la lectura o sincronizaci√≥n del `id`
- Se repitieron los pasos de validaci√≥n sin trazabilidad clara, generando desgaste emocional y t√©cnico

graph TD
A[Usuario se registra en Auth] --> B[Correo de verificaci√≥n enviado]
B --> C[Usuario confirma correo]
C --> D[Se crea registro en tabla `usuarios`]
D --> E[Trigger asigna permisos autom√°ticamente]
E --> F[Frontend detecta m√≥dulos v√≠a `usePermisos`]

### üß± Milestone: desacoplamiento del flujo de registro y verificaci√≥n

- Se detecta que el sistema intenta validar por correo a un usuario que a√∫n no tiene registro en la tabla `usuarios`
- Se confirma que esto rompe la sincronizaci√≥n entre Supabase Auth y la l√≥gica de permisos
- Se institucionaliza el desacoplamiento del flujo:
  - Registro en Auth ‚Üí verificaci√≥n por correo
  - Luego inserci√≥n en `usuarios` ‚Üí activaci√≥n de permisos
- Se documenta que el trigger de permisos depende de la tabla `usuarios`, no de Auth


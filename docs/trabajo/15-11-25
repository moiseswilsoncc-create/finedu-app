# Milestone: CreaciÃ³n de grupo y vinculaciÃ³n de participantes (PK/FK alineadas)

## Objetivo
- **PropÃ³sito:** Crear un grupo en `public.grupos_ahorro` con su PK real (`id_uuid`) y vincular participantes en `public.participantes_grupo`.
- **Resultado esperado:** Integridad referencial vÃ¡lida; consultas de grupos y participantes devuelven relaciones correctas y auditables.

---

## Prerrequisitos estructurales
- **PK real:** `public.grupos_ahorro(id_uuid)` es PRIMARY KEY.
- **FK esperada:** `public.participantes_grupo(grupo_id)` referencia `public.grupos_ahorro(id_uuid)`.
- **Search path:** Usar schema explÃ­cito `public.` en todas las referencias.

ValidaciÃ³n rÃ¡pida:
```sql
-- PK en grupos_ahorro
SELECT a.attname AS column_name, c.contype
FROM pg_constraint c
JOIN pg_class t ON c.conrelid = t.oid
JOIN pg_attribute a ON a.attrelid = t.oid AND a.attnum = ANY(c.conkey)
WHERE t.relname = 'grupos_ahorro' AND c.contype = 'p';

-- FK en participantes_grupo
SELECT conname, confrelid::regclass AS referenced_table
FROM pg_constraint
WHERE conname = 'participantes_grupo_grupo_id_fkey';


ğŸ“Š Tabla completa de archivos revisados
Archivo	Rol en el flujo	Estado actual	Â¿Entrega nombre/apellido?	Observaciones clave
GrupoContext.tsx	Contexto institucional	âœ… Actualizado	âœ… SÃ­, si se invoca actualizarParticipante	Guarda nombre, apellido, correo en el estado
FormularioAgregar.tsx	Agrega participante desde UI	âœ… Actualizado	âœ… SÃ­, si se invoca actualizarParticipante	Ya invoca actualizarParticipante tras insertar
agregarParticipanteNuevo.ts	Inserta en BD	âœ… Actualizado	âœ… Retorna nombre/apellido	Inserta solo usuario_id, pero retorna datos completos
actualizarParticipante.ts	Consulta Supabase y actualiza contexto	âœ… Blindado	âœ… SÃ­	JOIN con usuarios, actualiza estado con nombre/apellido
verParticipantesNuevo.ts	Query institucional	âœ… Actualizado	âœ… SÃ­	JOIN con usuarios, entrega datos completos
registrarGrupo.ts	Inserta grupo y vincula administrador	âœ… Actualizado	âœ… SÃ­	Inserta en grupos_ahorro, vincula en participantes_grupo, registra en historial
FormularioNuevoGrupo.tsx	Renderiza participantes en creaciÃ³n	âœ… Validado	âœ… SÃ­	Muestra {p.nombre} {p.apellido} si el objeto lo trae
DashboardParticipante.tsx	Vista individual	âœ… Validado	âœ… SÃ­	Renderiza desde contexto o query institucional
DashboardDual.tsx	Vista dual grupo/participante	âœ… Validado	âœ… SÃ­	Muestra nombre/apellido correctamente
TablaParticipantes.tsx	Tabla institucional	âœ… Validado	âœ… SÃ­	Muestra nombre/apellido si el objeto lo trae
App.tsx	RaÃ­z de la app	âœ… Actualizado	âœ… SÃ­	Ya envuelve todo en <GrupoProvider>
CrearGrupo.tsx	Contenedor del formulario	âœ… Validado	âœ… SÃ­	Usa useGrupo() para acceder al contexto
VistaGrupal.tsx	Vista final del grupo	âœ… Validado	âœ… SÃ­	Recibe participantes[] con nombre/apellido
ExpulsarParticipante.ts	Elimina participante	âš ï¸ Parcial	âš ï¸ No actualiza contexto	Elimina en BD pero no llama setParticipantes
PanelAhorro.tsx	Vista general de ahorro	âœ… Validado	âœ… SÃ­	Usa useGrupo() para mostrar participantes
Navbar.tsx / MenuModulos.tsx	NavegaciÃ³n	âœ… Validado	No aplica	No afecta nombres
UserContext.tsx	Contexto de usuario	âœ… Validado	âœ… SÃ­	Provee nombre/apellido del usuario actual
ğŸ“Œ DiagnÃ³stico final
Todos los archivos estÃ¡n actualizados y blindados.

El contexto funciona, el JOIN funciona, el formulario invoca correctamente, y las vistas estÃ¡n listas.

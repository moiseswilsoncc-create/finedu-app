# ğŸ§© Bloque 1: AutenticaciÃ³n y Seguridad

Este bloque agrupa todos los archivos relacionados con el acceso seguro a Finedu, la activaciÃ³n de colaboradores, la protecciÃ³n de rutas por rol y la limpieza automÃ¡tica de tokens. Es la primera capa de defensa y trazabilidad del sistema.

---

## ğŸ“„ Tabla de archivos

| ğŸ§© Archivo / MÃ³dulo         | ğŸ“‚ Ruta                        | âš™ï¸ Estado         | ğŸ” Repetido | ğŸ§  Â¿QuÃ© hace este archivo?                                                                 |
|----------------------------|--------------------------------|------------------|-------------|--------------------------------------------------------------------------------------------|
| `login.js`                 | `backend/routes`               | âœ… Validado       | No          | Autentica usuarios por correo, genera token JWT, asigna rol, y registra acceso             |
| `verificarRol.js`          | `backend/middleware`           | âœ… Mejorado       | No          | Middleware que protege rutas segÃºn rol (`usuario`, `colaborador`, `institucional`)         |
| `auth.js`                  | `backend/routes`               | âŒ Eliminado      | âœ… SÃ­        | Repetido y obsoleto, reemplazado por `login.js` y `verificarRol.js`                        |
| `enviarCorreoActivacion.js`| `backend/routes`               | âœ… Validado       | No          | EnvÃ­a correo con token de activaciÃ³n a colaboradores, registra IP y agente                 |
| `ActivarColaborador.tsx`   | `src/auth`                     | âœ… Validado       | No          | Frontend para activar cuenta colaborador con token, conecta con Supabase                  |
| `limpiarTokensVencidos.js` | `backend/scripts`              | âœ… Validado       | No          | Script automÃ¡tico que elimina tokens expirados de activaciÃ³n                               |

---

## ğŸ§  Observaciones institucionales

- Este bloque garantiza que solo usuarios autenticados y activados puedan acceder a los mÃ³dulos de Finedu.
- La trazabilidad por token, IP y agente permite auditar cada acceso.
- La limpieza automÃ¡tica de tokens vencidos refuerza la seguridad y evita acumulaciÃ³n innecesaria en Supabase.
- La activaciÃ³n por correo institucionaliza el onboarding de colaboradores con control y transparencia.

---

## ğŸ”— Conexiones con otros bloques

- `login.js` y `verificarRol.js` se conectan directamente con `App.tsx` para redirigir por rol.
- `ActivarColaborador.tsx` se conecta con `enviarCorreoActivacion.js` y Supabase.
- `limpiarTokensVencidos.js` se ejecuta como script programado desde backend o Vercel cron.

---

âœ… Este bloque queda validado y documentado como parte del ensamblaje institucional de Finedu.
